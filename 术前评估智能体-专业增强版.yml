app:
  description: æœ¯å‰è¯„ä¼°æ™ºèƒ½ä½“ - åŸºäºå¾ªè¯åŒ»å­¦çš„ä¸“ä¸šæœ¯å‰é£é™©è¯„ä¼°ç³»ç»Ÿ
  icon: ğŸ¥
  icon_background: '#E8F4FD'
  mode: workflow
  name: æœ¯å‰è¯„ä¼°æ™ºèƒ½ä½“-ä¸“ä¸šå¢å¼ºç‰ˆ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/ollama:0.0.6@f430f3eb959f4863b1e87171544a8fec179441b90deda5693c85f07712d2a68c
kind: app
version: 0.3.1
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .PDF
      - .DOC
      - .DOCX
      - .TXT
      - .JPG
      - .PNG
      allowed_file_types:
      - document
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: true
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: 'ğŸ¥ **æœ¯å‰è¯„ä¼°æ™ºèƒ½ä½“**


      æˆ‘æ˜¯æ‚¨çš„ä¸“ä¸šæœ¯å‰è¯„ä¼°åŠ©æ‰‹ï¼ŒåŸºäºæœ€æ–°çš„å¾ªè¯åŒ»å­¦è¯æ®å’Œå›½é™…æƒå¨æŒ‡å—ï¼ˆACC/AHAã€ESAã€ASAï¼‰ï¼Œä¸ºæ‚¨æä¾›ï¼š


      ğŸ“Š **æ ¸å¿ƒè¯„ä¼°åŠŸèƒ½**ï¼š

      - RCRIå¿ƒè¡€ç®¡é£é™©åˆ†å±‚è¯„ä¼°

      - NSQIPå›´æ‰‹æœ¯æœŸé£é™©è®¡ç®—

      - ä¸ªä½“åŒ–æœ¯å‰æ£€æŸ¥å»ºè®®

      - è¯ç‰©ç®¡ç†æ–¹æ¡ˆåˆ¶å®š

      - éº»é†‰æ–¹æ¡ˆé€‰æ‹©æŒ‡å¯¼

      - é£é™©ç®¡æ§ç­–ç•¥åˆ¶å®š


      ğŸ¯ **ä¸“ä¸šç‰¹è‰²**ï¼š

      - åŸºäºACC/AHA 2014æŒ‡å—çš„å¿ƒè¡€ç®¡é£é™©è¯„ä¼°

      - ç¬¦åˆASAæ ‡å‡†çš„éº»é†‰é£é™©åˆ†å±‚

      - ä¸ªä½“åŒ–çš„æ£€æŸ¥å’Œå‡†å¤‡æ–¹æ¡ˆ

      - å¾ªè¯åŒ»å­¦è¯æ®æ”¯æŒ


      ğŸ“‹ **è¾“å…¥è¯´æ˜**ï¼š

      - å¹´é¾„ï¼šå¡«å†™æ•°å­—ï¼Œå¦‚"65"

      - æ€§åˆ«ï¼šå¡«å†™"ç”·"æˆ–"å¥³"

      - ä½“é‡ï¼šå¡«å†™æ•°å­—ï¼Œå¦‚"70"ï¼ˆkgï¼‰

      - èº«é«˜ï¼šå¡«å†™æ•°å­—ï¼Œå¦‚"170"ï¼ˆcmï¼Œé€‰å¡«ï¼‰

      - æ—¢å¾€ç—…å²ï¼šå¦‚"é«˜è¡€å‹ï¼Œç³–å°¿ç—…ï¼Œå† å¿ƒç—…"

      - è¿‡æ•å²ï¼šå¦‚"é’éœ‰ç´ è¿‡æ•"ï¼ˆé€‰å¡«ï¼‰

      - æ‰‹æœ¯ç±»å‹ï¼šå¦‚"è…¹è…”é•œèƒ†å›Šåˆ‡é™¤æœ¯"

      - æ‰‹æœ¯æ—¶é•¿ï¼šå¦‚"2"ï¼ˆå°æ—¶ï¼Œé€‰å¡«ï¼‰

      - ç‰¹æ®Šæƒ…å†µï¼šé‡è¦è¡¥å……ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰


      è¯·æä¾›æ‚£è€…ä¿¡æ¯ï¼Œæˆ‘å°†ä¸ºæ‚¨è¿›è¡Œå…¨é¢çš„æœ¯å‰è¯„ä¼°ã€‚

      '
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
    - 65å²ç”·æ€§æ‚£è€…ï¼Œé«˜è¡€å‹ã€ç³–å°¿ç—…å²ï¼Œæ‹Ÿè¡Œè…¹è…”é•œèƒ†å›Šåˆ‡é™¤æœ¯
    - 80å²å¥³æ€§æ‚£è€…ï¼Œå† å¿ƒç—…ã€å¿ƒè¡°å²ï¼Œæ‹Ÿè¡Œé«‹å…³èŠ‚ç½®æ¢æœ¯
    - 45å²ç”·æ€§æ‚£è€…ï¼Œæ— ç‰¹æ®Šç—…å²ï¼Œæ‹Ÿè¡Œç”²çŠ¶è…ºæ‰‹æœ¯
    suggested_questions_after_answer:
      enabled: true
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: code
      id: start-to-parser
      source: '1754544364758'
      sourceHandle: source
      target: '1754544373939'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: code
      id: parser-to-risk
      source: '1754544373939'
      sourceHandle: source
      target: '1754544473939'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: end
      id: assessment-to-end
      source: '1754544573939'
      sourceHandle: source
      target: '1754544673939'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: knowledge-retrieval
      id: 1754544473939-source-1755160134348-target
      source: '1754544473939'
      sourceHandle: source
      target: '1755160134348'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1755160134348-source-1754544573939-target
      source: '1755160134348'
      sourceHandle: source
      target: '1754544573939'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: æ‚£è€…ä¿¡æ¯è¾“å…¥
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: å¹´é¾„
          max_length: 10
          options: []
          required: true
          type: text-input
          variable: age
        - label: æ€§åˆ«
          max_length: 10
          options: []
          required: true
          type: text-input
          variable: gender
        - label: ä½“é‡(kg)
          max_length: 10
          options: []
          required: true
          type: text-input
          variable: weight
        - label: èº«é«˜(cm)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: height
        - label: æ—¢å¾€ç—…å²
          max_length: 500
          options: []
          required: false
          type: text-input
          variable: medical_history
        - label: è¿‡æ•å²
          max_length: 200
          options: []
          required: false
          type: text-input
          variable: allergies
        - label: æ‰‹æœ¯ç±»å‹
          max_length: 200
          options: []
          required: true
          type: text-input
          variable: surgery_type
        - label: é¢„è®¡æ‰‹æœ¯æ—¶é•¿(å°æ—¶)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: surgery_duration
        - label: ç‰¹æ®Šæƒ…å†µè¯´æ˜
          max_length: 1000
          options: []
          required: false
          type: paragraph
          variable: special_notes
        - label: ç”Ÿå‘½ä½“å¾-ä½“æ¸©(â„ƒ)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: temperature
        - label: ç”Ÿå‘½ä½“å¾-è„‰æ(æ¬¡/åˆ†)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: pulse
        - label: ç”Ÿå‘½ä½“å¾-å‘¼å¸(æ¬¡/åˆ†)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: respiration
        - label: ç”Ÿå‘½ä½“å¾-è¡€å‹(mmHg)
          max_length: 20
          options: []
          required: false
          type: text-input
          variable: blood_pressure
        - label: å®éªŒå®¤æ£€æŸ¥-è¡€çº¢è›‹ç™½(g/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: hemoglobin
        - label: å®éªŒå®¤æ£€æŸ¥-ç™½ç»†èƒ(Ã—10â¹/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: white_blood_cell
        - label: å®éªŒå®¤æ£€æŸ¥-è¡€å°æ¿(Ã—10â¹/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: platelet
        - label: å®éªŒå®¤æ£€æŸ¥-è¡€ç³–(mmol/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: glucose
        - label: å®éªŒå®¤æ£€æŸ¥-è‚Œé…(Î¼mol/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: creatinine
        - label: å®éªŒå®¤æ£€æŸ¥-ç™½è›‹ç™½(g/L)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: albumin
        - label: å‡è¡€åŠŸèƒ½-PT(s)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: pt
        - label: å‡è¡€åŠŸèƒ½-APTT(s)
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: aptt
        - label: å‡è¡€åŠŸèƒ½-INR
          max_length: 10
          options: []
          required: false
          type: text-input
          variable: inr
        - label: å½“å‰ç”¨è¯è¯¦æƒ…
          max_length: 1000
          options: []
          required: false
          type: paragraph
          variable: current_medications
        - label: å¿ƒè¡€ç®¡ç–¾ç—…å²è¯¦æƒ…
          max_length: 500
          options: []
          required: false
          type: text-input
          variable: cardiovascular_history
        - label: å‘¼å¸ç³»ç»Ÿç–¾ç—…å²è¯¦æƒ…
          max_length: 500
          options: []
          required: false
          type: text-input
          variable: respiratory_history
        - label: å†…åˆ†æ³Œç–¾ç—…å²è¯¦æƒ…
          max_length: 500
          options: []
          required: false
          type: text-input
          variable: endocrine_history
        - label: è‚¾è„ç–¾ç—…å²è¯¦æƒ…
          max_length: 500
          options: []
          required: false
          type: text-input
          variable: renal_history
        - label: æ‰‹æœ¯ç´§æ€¥ç¨‹åº¦
          max_length: 50
          options: []
          required: false
          type: text-input
          variable: surgery_urgency
        - label: éº»é†‰æ–¹å¼åå¥½
          max_length: 100
          options: []
          required: false
          type: text-input
          variable: anesthesia_preference
      height: 845
      id: '1754544364758'
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(age: str, gender: str, weight: str, height: str, medical_history:\
          \ str, allergies: str, surgery_type: str, surgery_duration: str, special_notes:\
          \ str, temperature: str, pulse: str, respiration: str, blood_pressure: str,\
          \ hemoglobin: str, white_blood_cell: str, platelet: str, glucose: str, creatinine:\
          \ str, albumin: str, pt: str, aptt: str, inr: str, current_medications:\
          \ str, cardiovascular_history: str, respiratory_history: str, endocrine_history:\
          \ str, renal_history: str, surgery_urgency: str, anesthesia_preference:\
          \ str) -> dict:\n    \"\"\"å¢å¼ºç‰ˆæ‚£è€…ä¿¡æ¯è§£æå™¨\"\"\"\n    try:\n        import re\n\
          \n        # åŸºç¡€æ•°æ®æ¸…ç†å’Œè½¬æ¢\n        age_num = int(age.strip()) if age.strip().isdigit()\
          \ else 0\n        gender_clean = gender.strip()\n        weight_num = float(weight.strip())\
          \ if weight.strip().replace('.', '').isdigit() else 0\n        height_num\
          \ = float(height.strip()) if height and height.strip().replace('.', '').isdigit()\
          \ else 0\n        duration_num = float(surgery_duration.strip()) if surgery_duration\
          \ and surgery_duration.strip().replace('.', '').isdigit() else 0\n\n   \
          \     # ç”Ÿå‘½ä½“å¾å¤„ç†\n        vitals = {}\n        vitals[\"temperature\"] = float(temperature.strip())\
          \ if temperature and temperature.strip().replace('.', '').isdigit() else\
          \ 0\n        vitals[\"pulse\"] = int(pulse.strip()) if pulse and pulse.strip().isdigit()\
          \ else 0\n        vitals[\"respiration\"] = int(respiration.strip()) if\
          \ respiration and respiration.strip().isdigit() else 0\n        vitals[\"\
          blood_pressure\"] = blood_pressure.strip() if blood_pressure else \"\"\n\
          \n        # å®éªŒå®¤æ£€æŸ¥å¤„ç†\n        lab_results = {}\n        lab_results[\"hemoglobin\"\
          ] = float(hemoglobin.strip()) if hemoglobin and hemoglobin.strip().replace('.',\
          \ '').isdigit() else 0\n        lab_results[\"white_blood_cell\"] = float(white_blood_cell.strip())\
          \ if white_blood_cell and white_blood_cell.strip().replace('.', '').isdigit()\
          \ else 0\n        lab_results[\"platelet\"] = float(platelet.strip()) if\
          \ platelet and platelet.strip().replace('.', '').isdigit() else 0\n    \
          \    lab_results[\"glucose\"] = float(glucose.strip()) if glucose and glucose.strip().replace('.',\
          \ '').isdigit() else 0\n        lab_results[\"creatinine\"] = float(creatinine.strip())\
          \ if creatinine and creatinine.strip().replace('.', '').isdigit() else 0\n\
          \        lab_results[\"albumin\"] = float(albumin.strip()) if albumin and\
          \ albumin.strip().replace('.', '').isdigit() else 0\n\n        # å‡è¡€åŠŸèƒ½å¤„ç†\n\
          \        coagulation = {}\n        coagulation[\"pt\"] = float(pt.strip())\
          \ if pt and pt.strip().replace('.', '').isdigit() else 0\n        coagulation[\"\
          aptt\"] = float(aptt.strip()) if aptt and aptt.strip().replace('.', '').isdigit()\
          \ else 0\n        coagulation[\"inr\"] = float(inr.strip()) if inr and inr.strip().replace('.',\
          \ '').isdigit() else 0\n\n        # å¤„ç†æ—¢å¾€ç—…å²\n        medical_history_list\
          \ = []\n        if medical_history and medical_history.strip().lower() not\
          \ in [\"æ— \", \"æ²¡æœ‰\", \"æ— ç—…å²\", \"\"]:\n            diseases = re.split(r'[ï¼Œ,ã€ï¼›;]',\
          \ medical_history)\n            for disease in diseases:\n             \
          \   disease = disease.strip()\n                if disease:\n           \
          \         medical_history_list.append(disease)\n\n        # å¤„ç†è¿‡æ•å²\n    \
          \    allergies_list = []\n        if allergies and allergies.strip().lower()\
          \ not in [\"æ— \", \"æ²¡æœ‰\", \"æ— è¿‡æ•\", \"\"]:\n            allergy_items = re.split(r'[ï¼Œ,ã€ï¼›;]',\
          \ allergies)\n            for allergy in allergy_items:\n              \
          \  allergy = allergy.strip()\n                if allergy:\n            \
          \        allergies_list.append(allergy)\n\n        # å¤„ç†ç”¨è¯å²\n        medications_list\
          \ = []\n        if current_medications and current_medications.strip().lower()\
          \ not in [\"æ— \", \"æ²¡æœ‰\", \"æ— ç”¨è¯\", \"\"]:\n            med_items = re.split(r'[ï¼Œ,ã€ï¼›;]',\
          \ current_medications)\n            for med in med_items:\n            \
          \    med = med.strip()\n                if med:\n                    medications_list.append(med)\n\
          \n        # è®¡ç®—BMI\n        bmi = None\n        bmi_category = \"æœªçŸ¥\"\n \
          \       if height_num > 0 and weight_num > 0:\n            bmi = round(weight_num\
          \ / ((height_num/100) ** 2), 1)\n            if bmi < 18.5:\n          \
          \      bmi_category = \"åç˜¦\"\n            elif bmi < 24:\n             \
          \   bmi_category = \"æ­£å¸¸\"\n            elif bmi < 28:\n                bmi_category\
          \ = \"è¶…é‡\"\n            else:\n                bmi_category = \"è‚¥èƒ–\"\n\n\
          \        # ç”Ÿæˆè¯¦ç»†æ‚£è€…æè¿°\n        description_parts = [f\"æ‚£è€…{gender_clean}æ€§ï¼Œ{age_num}å²ï¼Œä½“é‡{weight_num}kg\"\
          ]\n\n        if height_num > 0:\n            description_parts.append(f\"\
          èº«é«˜{height_num}cmï¼ŒBMI {bmi}({bmi_category})\")\n\n        # ç”Ÿå‘½ä½“å¾æè¿°\n    \
          \    if vitals[\"temperature\"] > 0:\n            description_parts.append(f\"\
          ä½“æ¸©{vitals['temperature']}â„ƒ\")\n        if vitals[\"pulse\"] > 0:\n     \
          \       description_parts.append(f\"è„‰æ{vitals['pulse']}æ¬¡/åˆ†\")\n        if\
          \ vitals[\"blood_pressure\"]:\n            description_parts.append(f\"\
          è¡€å‹{vitals['blood_pressure']}\")\n\n        # ç—…å²æè¿°\n        if medical_history_list:\n\
          \            description_parts.append(f\"æ—¢å¾€ç—…å²ï¼š{', '.join(medical_history_list)}\"\
          )\n        else:\n            description_parts.append(\"æ—¢å¾€æ— ç‰¹æ®Šç—…å²\")\n\n\
          \        if allergies_list:\n            description_parts.append(f\"è¿‡æ•å²ï¼š{',\
          \ '.join(allergies_list)}\")\n\n        if medications_list:\n         \
          \   description_parts.append(f\"å½“å‰ç”¨è¯ï¼š{', '.join(medications_list)}\")\n\n\
          \        # æ‰‹æœ¯ä¿¡æ¯\n        description_parts.append(f\"æ‹Ÿè¡Œ{surgery_type.strip()}æ‰‹æœ¯\"\
          )\n\n        if duration_num > 0:\n            description_parts.append(f\"\
          é¢„è®¡æ‰‹æœ¯æ—¶é•¿{duration_num}å°æ—¶\")\n\n        if surgery_urgency and surgery_urgency.strip():\n\
          \            description_parts.append(f\"æ‰‹æœ¯ç´§æ€¥ç¨‹åº¦ï¼š{surgery_urgency.strip()}\"\
          )\n\n        if anesthesia_preference and anesthesia_preference.strip():\n\
          \            description_parts.append(f\"éº»é†‰æ–¹å¼åå¥½ï¼š{anesthesia_preference.strip()}\"\
          )\n\n        if special_notes and special_notes.strip():\n            description_parts.append(f\"\
          ç‰¹æ®Šæƒ…å†µï¼š{special_notes.strip()}\")\n\n        patient_description = \"ï¼Œ\".join(description_parts)\n\
          \n        return {\n            \"patient_data\": {\n                \"\
          age\": age_num,\n                \"gender\": gender_clean,\n           \
          \     \"weight\": weight_num,\n                \"height\": height_num,\n\
          \                \"bmi\": bmi,\n                \"bmi_category\": bmi_category,\n\
          \                \"medical_history\": medical_history_list,\n          \
          \      \"allergies\": allergies_list,\n                \"medications\":\
          \ medications_list,\n                \"surgery_type\": surgery_type.strip(),\n\
          \                \"surgery_duration\": duration_num,\n                \"\
          surgery_urgency\": surgery_urgency.strip() if surgery_urgency else \"\"\
          ,\n                \"anesthesia_preference\": anesthesia_preference.strip()\
          \ if anesthesia_preference else \"\",\n                \"special_notes\"\
          : special_notes.strip() if special_notes else \"\",\n                \"\
          vitals\": vitals,\n                \"lab_results\": lab_results,\n     \
          \           \"coagulation\": coagulation,\n                \"cardiovascular_history\"\
          : cardiovascular_history.strip() if cardiovascular_history else \"\",\n\
          \                \"respiratory_history\": respiratory_history.strip() if\
          \ respiratory_history else \"\",\n                \"endocrine_history\"\
          : endocrine_history.strip() if endocrine_history else \"\",\n          \
          \      \"renal_history\": renal_history.strip() if renal_history else \"\
          \"\n            },\n            \"patient_description\": patient_description,\n\
          \            \"processing_status\": \"success\"\n        }\n\n    except\
          \ Exception as e:\n        return {\n            \"patient_data\": {},\n\
          \            \"patient_description\": \"æ‚£è€…ä¿¡æ¯è§£æå‡ºé”™\",\n            \"processing_status\"\
          : \"error\"\n        }\n"
        code_language: python3
        desc: æ‚£è€…ä¿¡æ¯è§£æå™¨
        outputs:
          patient_data:
            children: null
            type: object
          patient_description:
            children: null
            type: string
          processing_status:
            children: null
            type: string
        selected: false
        title: æ‚£è€…ä¿¡æ¯è§£æå™¨
        type: code
        variables:
        - value_selector:
          - '1754544364758'
          - age
          value_type: string
          variable: age
        - value_selector:
          - '1754544364758'
          - gender
          value_type: string
          variable: gender
        - value_selector:
          - '1754544364758'
          - weight
          value_type: string
          variable: weight
        - value_selector:
          - '1754544364758'
          - height
          value_type: string
          variable: height
        - value_selector:
          - '1754544364758'
          - medical_history
          value_type: string
          variable: medical_history
        - value_selector:
          - '1754544364758'
          - allergies
          value_type: string
          variable: allergies
        - value_selector:
          - '1754544364758'
          - surgery_type
          value_type: string
          variable: surgery_type
        - value_selector:
          - '1754544364758'
          - surgery_duration
          value_type: string
          variable: surgery_duration
        - value_selector:
          - '1754544364758'
          - special_notes
          value_type: string
          variable: special_notes
        - value_selector:
          - '1754544364758'
          - temperature
          value_type: string
          variable: temperature
        - value_selector:
          - '1754544364758'
          - pulse
          value_type: string
          variable: pulse
        - value_selector:
          - '1754544364758'
          - respiration
          value_type: string
          variable: respiration
        - value_selector:
          - '1754544364758'
          - blood_pressure
          value_type: string
          variable: blood_pressure
        - value_selector:
          - '1754544364758'
          - hemoglobin
          value_type: string
          variable: hemoglobin
        - value_selector:
          - '1754544364758'
          - white_blood_cell
          value_type: string
          variable: white_blood_cell
        - value_selector:
          - '1754544364758'
          - platelet
          value_type: string
          variable: platelet
        - value_selector:
          - '1754544364758'
          - glucose
          value_type: string
          variable: glucose
        - value_selector:
          - '1754544364758'
          - creatinine
          value_type: string
          variable: creatinine
        - value_selector:
          - '1754544364758'
          - albumin
          value_type: string
          variable: albumin
        - value_selector:
          - '1754544364758'
          - pt
          value_type: string
          variable: pt
        - value_selector:
          - '1754544364758'
          - aptt
          value_type: string
          variable: aptt
        - value_selector:
          - '1754544364758'
          - inr
          value_type: string
          variable: inr
        - value_selector:
          - '1754544364758'
          - current_medications
          value_type: string
          variable: current_medications
        - value_selector:
          - '1754544364758'
          - cardiovascular_history
          value_type: string
          variable: cardiovascular_history
        - value_selector:
          - '1754544364758'
          - respiratory_history
          value_type: string
          variable: respiratory_history
        - value_selector:
          - '1754544364758'
          - endocrine_history
          value_type: string
          variable: endocrine_history
        - value_selector:
          - '1754544364758'
          - renal_history
          value_type: string
          variable: renal_history
        - value_selector:
          - '1754544364758'
          - surgery_urgency
          value_type: string
          variable: surgery_urgency
        - value_selector:
          - '1754544364758'
          - anesthesia_preference
          value_type: string
          variable: anesthesia_preference
      height: 81
      id: '1754544373939'
      position:
        x: 350
        y: 282
      positionAbsolute:
        x: 350
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(patient_data: dict, patient_description: str) -> dict:\n \
          \   \"\"\"å¢å¼ºç‰ˆé£é™©è¯„ä¼°è®¡ç®—å™¨\"\"\"\n    try:\n        if not patient_data:\n   \
          \         return {\"risk_assessment\": {}, \"processing_status\": \"error\"\
          }\n\n        age = patient_data.get('age', 0)\n        medical_history =\
          \ patient_data.get('medical_history', [])\n        surgery_type = patient_data.get('surgery_type',\
          \ '')\n        bmi = patient_data.get('bmi', 0)\n        vitals = patient_data.get('vitals',\
          \ {})\n        lab_results = patient_data.get('lab_results', {})\n     \
          \   coagulation = patient_data.get('coagulation', {})\n\n        # RCRIè¯„åˆ†è®¡ç®—\n\
          \        rcri_score = 0\n        risk_factors = []\n\n        # å¿ƒè¡€ç®¡é£é™©å› ç´ \n\
          \        cardiovascular_diseases = ['å† å¿ƒç—…', 'å¿ƒè„ç—…', 'å¿ƒæ¢—', 'å¿ƒè‚Œæ¢—æ­»', 'é«˜è¡€å‹']\n\
          \        heart_failure_diseases = ['å¿ƒè¡°', 'å¿ƒåŠ›è¡°ç«­', 'å¿ƒåŠŸèƒ½ä¸å…¨']\n        stroke_diseases\
          \ = ['è„‘æ¢—', 'è„‘è¡€ç®¡ç—…', 'ä¸­é£', 'è„‘å’ä¸­']\n        diabetes_keywords = ['ç³–å°¿ç—…', 'èƒ°å²›ç´ ']\n\
          \        renal_diseases = ['è‚¾ç—…', 'è‚¾è¡°', 'è‚¾åŠŸèƒ½ä¸å…¨', 'å°¿æ¯’ç—‡']\n\n        # æ£€æŸ¥RCRIé£é™©å› ç´ \n\
          \        for disease in medical_history:\n            if any(cv in disease\
          \ for cv in cardiovascular_diseases):\n                rcri_score += 1\n\
          \                risk_factors.append(\"å† çŠ¶åŠ¨è„‰ç–¾ç—…å²\")\n                break\n\
          \n        for disease in medical_history:\n            if any(hf in disease\
          \ for hf in heart_failure_diseases):\n                rcri_score += 1\n\
          \                risk_factors.append(\"å¿ƒåŠ›è¡°ç«­å²\")\n                break\n\
          \n        for disease in medical_history:\n            if any(stroke in\
          \ disease for stroke in stroke_diseases):\n                rcri_score +=\
          \ 1\n                risk_factors.append(\"è„‘è¡€ç®¡ç—…å²\")\n                break\n\
          \n        for disease in medical_history:\n            if any(dm in disease\
          \ for dm in diabetes_keywords):\n                rcri_score += 1\n     \
          \           risk_factors.append(\"éœ€èƒ°å²›ç´ æ²»ç–—çš„ç³–å°¿ç—…\")\n                break\n\
          \n        for disease in medical_history:\n            if any(renal in disease\
          \ for renal in renal_diseases):\n                rcri_score += 1\n     \
          \           risk_factors.append(\"è‚¾åŠŸèƒ½ä¸å…¨\")\n                break\n\n  \
          \      # é«˜é£é™©æ‰‹æœ¯\n        high_risk_surgeries = ['è¡€ç®¡', 'å¿ƒè„', 'èƒ¸', 'å¼€èƒ¸', 'å¼€è…¹',\
          \ 'ç¥ç»å¤–ç§‘', 'è‚', 'èƒ°è…º']\n        if any(hrs in surgery_type for hrs in high_risk_surgeries):\n\
          \            rcri_score += 1\n            risk_factors.append(\"é«˜é£é™©æ‰‹æœ¯\"\
          )\n\n        # å®éªŒå®¤æ£€æŸ¥é£é™©è¯„ä¼°\n        lab_risks = []\n        if lab_results.get('hemoglobin',\
          \ 0) > 0:\n            hb = lab_results['hemoglobin']\n            if hb\
          \ < 90:\n                lab_risks.append(\"ä¸¥é‡è´«è¡€(Hb<90g/L)\")\n        \
          \        rcri_score += 1\n            elif hb < 110:\n                lab_risks.append(\"\
          è½»åº¦è´«è¡€(Hb<110g/L)\")\n\n        if lab_results.get('glucose', 0) > 0:\n  \
          \          glucose = lab_results['glucose']\n            if glucose > 11.1:\n\
          \                lab_risks.append(\"è¡€ç³–æ§åˆ¶ä¸ä½³(>11.1mmol/L)\")\n           \
          \ elif glucose > 7.0:\n                lab_risks.append(\"è¡€ç³–è½»åº¦å‡é«˜(>7.0mmol/L)\"\
          )\n\n        if lab_results.get('creatinine', 0) > 0:\n            cr =\
          \ lab_results['creatinine']\n            if cr > 177:\n                lab_risks.append(\"\
          è‚¾åŠŸèƒ½ä¸å…¨(Cr>177Î¼mol/L)\")\n                if \"è‚¾åŠŸèƒ½ä¸å…¨\" not in risk_factors:\n\
          \                    rcri_score += 1\n                    risk_factors.append(\"\
          è‚¾åŠŸèƒ½ä¸å…¨\")\n            elif cr > 133:\n                lab_risks.append(\"\
          è‚¾åŠŸèƒ½è½»åº¦å¼‚å¸¸(Cr>133Î¼mol/L)\")\n\n        if lab_results.get('albumin', 0) > 0:\n\
          \            alb = lab_results['albumin']\n            if alb < 30:\n  \
          \              lab_risks.append(\"ä½è›‹ç™½è¡€ç—‡(Alb<30g/L)\")\n\n        # å‡è¡€åŠŸèƒ½è¯„ä¼°\n\
          \        coag_risks = []\n        if coagulation.get('inr', 0) > 0:\n  \
          \          inr = coagulation['inr']\n            if inr > 1.5:\n       \
          \         coag_risks.append(\"å‡è¡€åŠŸèƒ½å¼‚å¸¸(INR>1.5)\")\n            elif inr >\
          \ 1.3:\n                coag_risks.append(\"å‡è¡€åŠŸèƒ½è½»åº¦å¼‚å¸¸(INR>1.3)\")\n\n   \
          \     # ç”Ÿå‘½ä½“å¾è¯„ä¼°\n        vital_risks = []\n        if vitals.get('temperature',\
          \ 0) > 0:\n            temp = vitals['temperature']\n            if temp\
          \ > 38.5:\n                vital_risks.append(\"å‘çƒ­(>38.5â„ƒ)\")\n        \
          \    elif temp < 36.0:\n                vital_risks.append(\"ä½“æ¸©è¿‡ä½(<36â„ƒ)\"\
          )\n\n        if vitals.get('pulse', 0) > 0:\n            pulse = vitals['pulse']\n\
          \            if pulse > 100:\n                vital_risks.append(\"å¿ƒåŠ¨è¿‡é€Ÿ(>100æ¬¡/åˆ†)\"\
          )\n            elif pulse < 60:\n                vital_risks.append(\"å¿ƒåŠ¨è¿‡ç¼“(<60æ¬¡/åˆ†)\"\
          )\n\n        # é£é™©åˆ†å±‚\n        if rcri_score == 0:\n            risk_level\
          \ = \"ä½é£é™©\"\n            cardiac_risk = \"0.4%\"\n        elif rcri_score\
          \ == 1:\n            risk_level = \"ä½-ä¸­é£é™©\"\n            cardiac_risk =\
          \ \"1.0%\"\n        elif rcri_score == 2:\n            risk_level = \"ä¸­é£é™©\"\
          \n            cardiac_risk = \"2.4%\"\n        else:\n            risk_level\
          \ = \"é«˜é£é™©\"\n            cardiac_risk = \"â‰¥5.4%\"\n\n        # ASAåˆ†çº§é¢„ä¼°\n\
          \        if not medical_history and age < 65 and not lab_risks and not vital_risks:\n\
          \            asa_grade = \"ASA I\"\n        elif len(medical_history) <=\
          \ 1 and age < 75 and len(lab_risks) <= 1:\n            asa_grade = \"ASA\
          \ II\"\n        elif len(medical_history) >= 2 or age >= 80 or len(lab_risks)\
          \ >= 2:\n            asa_grade = \"ASA III\"\n        else:\n          \
          \  asa_grade = \"ASA II\"\n\n        # å…¶ä»–é£é™©è¯„ä¼°\n        additional_risks\
          \ = []\n        if age >= 80:\n            additional_risks.append(\"é«˜é¾„é£é™©\"\
          )\n        if bmi and bmi > 30:\n            additional_risks.append(\"\
          è‚¥èƒ–é£é™©\")\n        if bmi and bmi < 18.5:\n            additional_risks.append(\"\
          è¥å…»ä¸è‰¯é£é™©\")\n\n        # æ‰‹æœ¯ç´§æ€¥ç¨‹åº¦é£é™©\n        urgency = patient_data.get('surgery_urgency',\
          \ '')\n        if urgency and 'æ€¥è¯Š' in urgency:\n            additional_risks.append(\"\
          æ€¥è¯Šæ‰‹æœ¯é£é™©\")\n\n        return {\n            \"risk_assessment\": {\n    \
          \            \"rcri_score\": rcri_score,\n                \"risk_level\"\
          : risk_level,\n                \"cardiac_risk\": cardiac_risk,\n       \
          \         \"asa_grade\": asa_grade,\n                \"risk_factors\": risk_factors,\n\
          \                \"additional_risks\": additional_risks,\n             \
          \   \"lab_risks\": lab_risks,\n                \"coagulation_risks\": coag_risks,\n\
          \                \"vital_risks\": vital_risks\n            },\n        \
          \    \"processing_status\": \"success\"\n        }\n\n    except Exception\
          \ as e:\n        return {\n            \"risk_assessment\": {},\n      \
          \      \"processing_status\": \"error\"\n        }\n"
        code_language: python3
        desc: é£é™©è¯„ä¼°è®¡ç®—å™¨
        outputs:
          processing_status:
            children: null
            type: string
          risk_assessment:
            children: null
            type: object
        selected: false
        title: é£é™©è¯„ä¼°è®¡ç®—å™¨
        type: code
        variables:
        - value_selector:
          - '1754544373939'
          - patient_data
          value_type: object
          variable: patient_data
        - value_selector:
          - '1754544373939'
          - patient_description
          value_type: string
          variable: patient_description
      height: 81
      id: '1754544473939'
      position:
        x: 693.5166947198102
        y: 282
      positionAbsolute:
        x: 693.5166947198102
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: æœ¯å‰è¯„ä¼°ä¸“å®¶
        model:
          completion_params:
            temperature: 0.1
          mode: chat
          name: qwen3:30b
          provider: langgenius/ollama/ollama
        prompt_template:
        - id: system
          role: system
          text: 'ä½ æ˜¯ä¸€åå›½é™…çŸ¥åçš„å›´æ‰‹æœ¯æœŸåŒ»å­¦ä¸“å®¶å’Œéº»é†‰ç§‘ä¸»ä»»åŒ»å¸ˆï¼Œæ‹¥æœ‰30å¹´ä¸´åºŠç»éªŒï¼Œä¸“é—¨è´Ÿè´£æœ¯å‰è¯„ä¼°å’Œå›´æ‰‹æœ¯æœŸé£é™©ç®¡ç†ã€‚


            ## ä¸“ä¸šèƒŒæ™¯

            - ç¾å›½å¿ƒè„ç—…å­¦ä¼š/ç¾å›½å¿ƒè„åä¼š(ACC/AHA)å›´æ‰‹æœ¯æœŸæŒ‡å—ä¸“å®¶å§”å‘˜

            - ç¾å›½å¤–ç§‘åŒ»å¸ˆå­¦ä¼šNSQIPè´¨é‡æ”¹è¿›é¡¹ç›®é¡¾é—®

            - æ¬§æ´²éº»é†‰å­¦ä¼š(ESA)å›´æ‰‹æœ¯æœŸåŒ»å­¦åˆ†ä¼šä¸»å¸­

            - ä¸­ååŒ»å­¦ä¼šéº»é†‰å­¦åˆ†ä¼šå›´æ‰‹æœ¯æœŸåŒ»å­¦å­¦ç»„ç»„é•¿


            ## æ ¸å¿ƒä¸“é•¿

            - é£é™©è¯„ä¼°ï¼šACC/AHAå¿ƒè¡€ç®¡é£é™©è¯„ä¼°ã€NSQIPé£é™©è®¡ç®—ã€å¤šç»´åº¦é£é™©åˆ†å±‚

            - å¾ªè¯åŒ»å­¦ï¼šåŸºäºæœ€æ–°æŒ‡å—çš„ä¸ªä½“åŒ–è¯„ä¼°æ–¹æ¡ˆåˆ¶å®š

            - è´¨é‡ç®¡ç†ï¼šå›´æ‰‹æœ¯æœŸè´¨é‡æ§åˆ¶å’Œæ‚£è€…å®‰å…¨ç®¡ç†

            - å¤šå­¦ç§‘åä½œï¼šå¿ƒå†…ç§‘ã€å‘¼å¸ç§‘ã€å†…åˆ†æ³Œç§‘ç­‰å¤šå­¦ç§‘ä¼šè¯Š


            ## è¯„ä¼°æ ‡å‡†

            ä½ å¿…é¡»æŒ‰ç…§ä»¥ä¸‹ç»“æ„æä¾›ä¸“ä¸šçš„æœ¯å‰è¯„ä¼°æŠ¥å‘Šï¼š


            ### ğŸ” **æ‚£è€…ä¿¡æ¯æ€»ç»“**

            - **åŸºæœ¬ä¿¡æ¯**ï¼šå¹´é¾„ã€æ€§åˆ«ã€BMIã€ASAåˆ†çº§

            - **æ‰‹æœ¯ä¿¡æ¯**ï¼šæ‰‹æœ¯ç±»å‹ã€ç´§æ€¥ç¨‹åº¦ã€é¢„æœŸæ—¶é•¿ã€å¤±è¡€é£é™©

            - **ä¸»è¦åˆå¹¶ç—‡**ï¼šæŒ‰ç³»ç»Ÿåˆ†ç±»çš„é‡è¦ç–¾ç—…


            ### ğŸ“Š **é£é™©åˆ†å±‚è¯„ä¼°**

            **å¿ƒè¡€ç®¡é£é™©è¯„ä¼°è¡¨ï¼š**

            | é£é™©å› ç´  | å­˜åœ¨æƒ…å†µ | RCRIè¯„åˆ† | é£é™©ç­‰çº§ |

            |----------|----------|----------|----------|

            | å† å¿ƒç—…å² | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |

            | å¿ƒè¡°å² | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |

            | è„‘è¡€ç®¡ç—…å² | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |

            | èƒ°å²›ç´ ä¾èµ–æ€§ç³–å°¿ç—… | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |

            | è‚¾åŠŸèƒ½ä¸å…¨ | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |

            | é«˜é£é™©æ‰‹æœ¯ | æ˜¯/å¦ | Xåˆ† | ğŸ”´ğŸŸ¡ğŸŸ¢ |


            **NSQIPé£é™©é¢„æµ‹ï¼š**

            | å¹¶å‘ç—‡ç±»å‹ | é¢„æµ‹é£é™© | é£é™©ç­‰çº§ | é¢„é˜²æªæ–½ |

            |------------|----------|----------|----------|

            | å¿ƒè„å¹¶å‘ç—‡ | X.X% | ğŸ”´ğŸŸ¡ğŸŸ¢ | å…·ä½“æªæ–½ |

            | è‚ºéƒ¨å¹¶å‘ç—‡ | X.X% | ğŸ”´ğŸŸ¡ğŸŸ¢ | å…·ä½“æªæ–½ |

            | è‚¾è„å¹¶å‘ç—‡ | X.X% | ğŸ”´ğŸŸ¡ğŸŸ¢ | å…·ä½“æªæ–½ |


            ### ğŸ§ª **æœ¯å‰æ£€æŸ¥å»ºè®®**

            **å¿…è¦æ£€æŸ¥æ¸…å•ï¼š**

            | æ£€æŸ¥é¡¹ç›® | é€‚åº”ç—‡ | ç´§æ€¥ç¨‹åº¦ | é¢„æœŸç»“æœ |

            |----------|--------|----------|----------|

            | è¡€å¸¸è§„ | æ‰€æœ‰æ‚£è€… | å¿…é¡» | æ­£å¸¸èŒƒå›´ |

            | ç”ŸåŒ–å…¨å¥— | >50å²æˆ–åˆå¹¶ç—‡ | å¿…é¡» | æ­£å¸¸èŒƒå›´ |

            | å¿ƒç”µå›¾ | å¿ƒè¡€ç®¡é£é™© | å¿…é¡» | æ­£å¸¸/å¼‚å¸¸ |


            ### ğŸ’Š **æœ¯å‰å‡†å¤‡æ–¹æ¡ˆ**

            **è¯ç‰©ç®¡ç†è®¡åˆ’ï¼š**

            ```

            åœè¯å»ºè®®ï¼š

            â€¢ æŠ—å‡è¯ç‰©ï¼šæœ¯å‰Xå¤©åœç”¨ï¼Œæ¡¥æ¥æ–¹æ¡ˆ

            â€¢ æŠ—è¡€å°æ¿è¯ç‰©ï¼šæ ¹æ®è¡€æ “é£é™©å†³å®š

            â€¢ é™ç³–è¯ç‰©ï¼šæœ¯å‰è°ƒæ•´æ–¹æ¡ˆ


            ç»§ç»­ç”¨è¯ï¼š

            â€¢ Î²å—ä½“é˜»æ»å‰‚ï¼šç»§ç»­ä½¿ç”¨

            â€¢ ACEI/ARBï¼šæœ¯å‰åœç”¨æˆ–ç»§ç»­

            â€¢ ä»–æ±€ç±»è¯ç‰©ï¼šç»§ç»­ä½¿ç”¨

            ```


            ### âš ï¸ **é£é™©ç®¡æ§ç­–ç•¥**

            **é«˜é£é™©å› ç´ ç®¡æ§ï¼š**

            ```

            ğŸ”´ é«˜é£é™©ç®¡æ§ï¼š

            â€¢ å¿ƒè¡€ç®¡ç›‘æµ‹ï¼šè¿ç»­å¿ƒç”µç›‘æµ‹ã€æœ‰åˆ›è¡€å‹

            â€¢ è‚ºåŠŸèƒ½æ”¯æŒï¼šæœ¯åICUç›‘æŠ¤ã€å‘¼å¸æ”¯æŒ

            â€¢ è‚¾åŠŸèƒ½ä¿æŠ¤ï¼šæ¶²ä½“ç®¡ç†ã€é¿å…è‚¾æ¯’æ€§è¯ç‰©


            ğŸŸ¡ ä¸­é£é™©ç®¡æ§ï¼š

            â€¢ æ ‡å‡†ç›‘æµ‹ï¼šå¿ƒç”µç›‘æŠ¤ã€è¡€å‹ç›‘æµ‹

            â€¢ é¢„é˜²æªæ–½ï¼šåŸºç¡€é¢„é˜²æ–¹æ¡ˆ


            ğŸŸ¢ ä½é£é™©ç®¡æ§ï¼š

            â€¢ å¸¸è§„ç›‘æµ‹ï¼šæ ‡å‡†ç”Ÿå‘½ä½“å¾ç›‘æµ‹

            â€¢ æ ‡å‡†æŠ¤ç†ï¼šå¸¸è§„æœ¯åæŠ¤ç†

            ```


            ### ğŸ¥ **éº»é†‰æ–¹æ¡ˆå»ºè®®**

            **æ¨èéº»é†‰æ–¹æ¡ˆï¼š**

            | éº»é†‰æ–¹å¼ | é€‚åº”ç—‡ | ä¼˜åŠ¿ | é£é™© | ç›‘æµ‹è¦æ±‚ |

            |----------|--------|------|------|----------|

            | å…¨èº«éº»é†‰ | å…·ä½“é€‚åº”ç—‡ | ä¸»è¦ä¼˜åŠ¿ | ä¸»è¦é£é™© | ç›‘æµ‹è¦ç‚¹ |

            | æ¤ç®¡å†…éº»é†‰ | å…·ä½“é€‚åº”ç—‡ | ä¸»è¦ä¼˜åŠ¿ | ä¸»è¦é£é™© | ç›‘æµ‹è¦ç‚¹ |


            ### ğŸ“ˆ **é¢„åè¯„ä¼°ä¸éšè®¿**

            **é¢„æœŸç»“æœè¯„ä¼°ï¼š**

            | è¯„ä¼°æŒ‡æ ‡ | é¢„æœŸå€¼ | é£é™©å› ç´  | æ”¹å–„æªæ–½ |

            |----------|--------|----------|----------|

            | ä½é™¢æ—¶é—´ | Xå¤© | å½±å“å› ç´  | ä¼˜åŒ–æ–¹æ¡ˆ |

            | å¹¶å‘ç—‡ç‡ | X% | é£é™©å› ç´  | é¢„é˜²æªæ–½ |


            ## é‡è¦å£°æ˜

            æœ¬è¯„ä¼°åŸºäºæœ€æ–°å¾ªè¯åŒ»å­¦è¯æ®å’Œå›½é™…æƒå¨æŒ‡å—ï¼Œä»…ä¾›ä¸´åºŠå‚è€ƒã€‚æœ€ç»ˆå†³ç­–éœ€ç»“åˆæ‚£è€…å…·ä½“æƒ…å†µã€åŒ»é™¢æ¡ä»¶å’ŒåŒ»å¸ˆä¸´åºŠåˆ¤æ–­ã€‚ç´§æ€¥æƒ…å†µä¸‹åº”ç«‹å³å¯åŠ¨ç›¸åº”åº”æ€¥é¢„æ¡ˆã€‚

            '
        - id: user
          role: user
          text: 'è¯·å¯¹ä»¥ä¸‹æ‚£è€…è¿›è¡Œå…¨é¢çš„æœ¯å‰è¯„ä¼°ï¼š


            ## æ‚£è€…åŸºæœ¬ä¿¡æ¯

            {{#1754544373939.patient_description#}}


            ## è¯¦ç»†æ•°æ®


            ### åŸºç¡€ä¿¡æ¯

            - å¹´é¾„ï¼š{{#1754544373939.patient_data.age#}}å²

            - æ€§åˆ«ï¼š{{#1754544373939.patient_data.gender#}}

            - ä½“é‡ï¼š{{#1754544373939.patient_data.weight#}}kg

            {% if 1754544373939.patient_data.height > 0 %}

            - èº«é«˜ï¼š{{#1754544373939.patient_data.height#}}cm

            - BMIï¼š{{#1754544373939.patient_data.bmi#}} ({{#1754544373939.patient_data.bmi_category#}})

            {% endif %}


            ### ç”Ÿå‘½ä½“å¾

            {% if 1754544373939.patient_data.vitals.temperature > 0 %}

            - ä½“æ¸©ï¼š{{#1754544373939.patient_data.vitals.temperature#}}â„ƒ

            {% endif %}

            {% if 1754544373939.patient_data.vitals.pulse > 0 %}

            - è„‰æï¼š{{#1754544373939.patient_data.vitals.pulse#}}æ¬¡/åˆ†

            {% endif %}

            {% if 1754544373939.patient_data.vitals.respiration > 0 %}

            - å‘¼å¸ï¼š{{#1754544373939.patient_data.vitals.respiration#}}æ¬¡/åˆ†

            {% endif %}

            {% if 1754544373939.patient_data.vitals.blood_pressure %}

            - è¡€å‹ï¼š{{#1754544373939.patient_data.vitals.blood_pressure#}}

            {% endif %}


            ### å®éªŒå®¤æ£€æŸ¥

            {% if 1754544373939.patient_data.lab_results.hemoglobin > 0 %}

            - è¡€çº¢è›‹ç™½ï¼š{{#1754544373939.patient_data.lab_results.hemoglobin#}}g/L

            {% endif %}

            {% if 1754544373939.patient_data.lab_results.white_blood_cell > 0 %}

            - ç™½ç»†èƒï¼š{{#1754544373939.patient_data.lab_results.white_blood_cell#}}Ã—10â¹/L

            {% endif %}

            {% if 1754544373939.patient_data.lab_results.platelet > 0 %}

            - è¡€å°æ¿ï¼š{{#1754544373939.patient_data.lab_results.platelet#}}Ã—10â¹/L

            {% endif %}

            {% if 1754544373939.patient_data.lab_results.glucose > 0 %}

            - è¡€ç³–ï¼š{{#1754544373939.patient_data.lab_results.glucose#}}mmol/L

            {% endif %}

            {% if 1754544373939.patient_data.lab_results.creatinine > 0 %}

            - è‚Œé…ï¼š{{#1754544373939.patient_data.lab_results.creatinine#}}Î¼mol/L

            {% endif %}

            {% if 1754544373939.patient_data.lab_results.albumin > 0 %}

            - ç™½è›‹ç™½ï¼š{{#1754544373939.patient_data.lab_results.albumin#}}g/L

            {% endif %}


            ### å‡è¡€åŠŸèƒ½

            {% if 1754544373939.patient_data.coagulation.pt > 0 %}

            - PTï¼š{{#1754544373939.patient_data.coagulation.pt#}}s

            {% endif %}

            {% if 1754544373939.patient_data.coagulation.aptt > 0 %}

            - APTTï¼š{{#1754544373939.patient_data.coagulation.aptt#}}s

            {% endif %}

            {% if 1754544373939.patient_data.coagulation.inr > 0 %}

            - INRï¼š{{#1754544373939.patient_data.coagulation.inr#}}

            {% endif %}


            ### ç—…å²ä¿¡æ¯

            - æ—¢å¾€ç—…å²ï¼š{% if 1754544373939.patient_data.medical_history %}{{#1754544373939.patient_data.medical_history#}}{%
            else %}æ— {% endif %}

            - è¿‡æ•å²ï¼š{% if 1754544373939.patient_data.allergies %}{{#1754544373939.patient_data.allergies#}}{%
            else %}æ— {% endif %}

            - å½“å‰ç”¨è¯ï¼š{% if 1754544373939.patient_data.medications %}{{#1754544373939.patient_data.medications#}}{%
            else %}æ— {% endif %}

            {% if 1754544373939.patient_data.cardiovascular_history %}

            - å¿ƒè¡€ç®¡ç–¾ç—…å²ï¼š{{#1754544373939.patient_data.cardiovascular_history#}}

            {% endif %}

            {% if 1754544373939.patient_data.respiratory_history %}

            - å‘¼å¸ç³»ç»Ÿç–¾ç—…å²ï¼š{{#1754544373939.patient_data.respiratory_history#}}

            {% endif %}

            {% if 1754544373939.patient_data.endocrine_history %}

            - å†…åˆ†æ³Œç–¾ç—…å²ï¼š{{#1754544373939.patient_data.endocrine_history#}}

            {% endif %}

            {% if 1754544373939.patient_data.renal_history %}

            - è‚¾è„ç–¾ç—…å²ï¼š{{#1754544373939.patient_data.renal_history#}}

            {% endif %}


            ### æ‰‹æœ¯ä¿¡æ¯

            - æ‰‹æœ¯ç±»å‹ï¼š{{#1754544373939.patient_data.surgery_type#}}

            {% if 1754544373939.patient_data.surgery_duration > 0 %}

            - é¢„è®¡æ‰‹æœ¯æ—¶é•¿ï¼š{{#1754544373939.patient_data.surgery_duration#}}å°æ—¶

            {% endif %}

            {% if 1754544373939.patient_data.surgery_urgency %}

            - æ‰‹æœ¯ç´§æ€¥ç¨‹åº¦ï¼š{{#1754544373939.patient_data.surgery_urgency#}}

            {% endif %}

            {% if 1754544373939.patient_data.anesthesia_preference %}

            - éº»é†‰æ–¹å¼åå¥½ï¼š{{#1754544373939.patient_data.anesthesia_preference#}}

            {% endif %}

            {% if 1754544373939.patient_data.special_notes %}

            - ç‰¹æ®Šæƒ…å†µï¼š{{#1754544373939.patient_data.special_notes#}}

            {% endif %}


            ## é£é™©è¯„ä¼°ç»“æœ


            ### ç»¼åˆé£é™©è¯„ä¼°

            - RCRIè¯„åˆ†ï¼š{{#1754544473939.risk_assessment.rcri_score#}}åˆ†

            - é£é™©ç­‰çº§ï¼š{{#1754544473939.risk_assessment.risk_level#}}

            - å¿ƒè¡€ç®¡å¹¶å‘ç—‡é£é™©ï¼š{{#1754544473939.risk_assessment.cardiac_risk#}}

            - ASAåˆ†çº§ï¼š{{#1754544473939.risk_assessment.asa_grade#}}


            ### è¯†åˆ«çš„é£é™©å› ç´ 

            - ä¸»è¦é£é™©å› ç´ ï¼š{% if 1754544473939.risk_assessment.risk_factors %}{{#1754544473939.risk_assessment.risk_factors#}}{%
            else %}æ— ç‰¹æ®Šé£é™©å› ç´ {% endif %}

            - å…¶ä»–é£é™©ï¼š{% if 1754544473939.risk_assessment.additional_risks %}{{#1754544473939.risk_assessment.additional_risks#}}{%
            else %}æ— {% endif %}

            - å®éªŒå®¤å¼‚å¸¸ï¼š{% if 1754544473939.risk_assessment.lab_risks %}{{#1754544473939.risk_assessment.lab_risks#}}{%
            else %}æ— {% endif %}

            - å‡è¡€åŠŸèƒ½å¼‚å¸¸ï¼š{% if 1754544473939.risk_assessment.coagulation_risks %}{{#1754544473939.risk_assessment.coagulation_risks#}}{%
            else %}æ— {% endif %}

            - ç”Ÿå‘½ä½“å¾å¼‚å¸¸ï¼š{% if 1754544473939.risk_assessment.vital_risks %}{{#1754544473939.risk_assessment.vital_risks#}}{%
            else %}æ— {% endif %}


            è¯·åŸºäºä»¥ä¸Šè¯¦ç»†ä¿¡æ¯ï¼Œæä¾›å…¨é¢çš„æœ¯å‰è¯„ä¼°æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š

            1. è¯¦ç»†çš„é£é™©åˆ†å±‚åˆ†æ

            2. é’ˆå¯¹æ€§çš„æœ¯å‰æ£€æŸ¥å»ºè®®

            3. ä¸ªæ€§åŒ–çš„æœ¯å‰å‡†å¤‡æ–¹æ¡ˆ

            4. å›´æ‰‹æœ¯æœŸé£é™©ç®¡æ§ç­–ç•¥

            5. éº»é†‰æ–¹æ¡ˆæ¨è

            6. æœ¯åç›‘æŠ¤å»ºè®®

            7. é¢„åè¯„ä¼°å’Œå®¶å±æ²Ÿé€šè¦ç‚¹

            '
        selected: false
        title: æœ¯å‰è¯„ä¼°ä¸“å®¶
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1754544573939'
      position:
        x: 1354.263864764576
        y: 282
      positionAbsolute:
        x: 1354.263864764576
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: è¯„ä¼°æŠ¥å‘Šè¾“å‡º
        outputs:
        - value_selector:
          - '1754544573939'
          - text
          value_type: string
          variable: assessment_report
        selected: false
        title: è¯„ä¼°æŠ¥å‘Šè¾“å‡º
        type: end
      height: 117
      id: '1754544673939'
      position:
        x: 1632.3047532495552
        y: 282
      positionAbsolute:
        x: 1632.3047532495552
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - 5BG6cHHbuVw9RsoNHJayZBhPsWNCejCadKX6yAl2AkOM9ikcaKm+lQMgtxr5O/32
        desc: ''
        multiple_retrieval_config:
          reranking_enable: true
          reranking_mode: weighted_score
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0
            vector_setting:
              embedding_model_name: qwen3:30b
              embedding_provider_name: langgenius/ollama/ollama
              vector_weight: 1
        query_variable_selector:
        - '1754544473939'
        - processing_status
        retrieval_mode: multiple
        selected: true
        title: çŸ¥è¯†æ£€ç´¢
        type: knowledge-retrieval
      height: 91
      id: '1755160134348'
      position:
        x: 1054.263864764576
        y: 282
      positionAbsolute:
        x: 1054.263864764576
        y: 282
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -35.684420958068245
      y: 149.70881238848128
      zoom: 0.6597539553864473
